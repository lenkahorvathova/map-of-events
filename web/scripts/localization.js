const localizationStrings = {
    'website_title': {
        'en': "Map of Events",
        'cs': "Mapa akcií"
    },
    'top_navigation_bar_events_map': {
        'en': "Events Map",
        'cs': "Mapa akcí"
    },
    'top_navigation_bar_crawler_status': {
        'en': "Crawler Status",
        'cs': "Stav prohledávače"
    },
    'top_navigation_bar_calendar_sources': {
        'en': "Calendar Sources",
        'cs': "Zdroje kalendářů"
    },
    'top_navigation_bar_latest_logs': {
        'en': "Latest Log Files",
        'cs': "Nejposlednější záznamy"
    },
    'top_navigation_bar_latest_logs_execution': {
        'en': "Log from Execution",
        'cs': "Záznam ze spuštení"
    },
    'top_navigation_bar_latest_logs_geocoding': {
        'en': "Záznam z geokódování"
    },
    'gps_latitude': {
        'en': "Latitude",
        'cs': "Zeměpisná šířka"
    },
    'gps_longitude': {
        'en': "Longitude",
        'cs': "Zeměpisná délka"
    },
    'modal_table_column_location': {
        'en': "Location",
        'cs': "Poloha"
    },
    'modal_gps_table_title': {
        'en': "Location Search Results",
        'cs': "Výsledky vyhledávání polohy"
    },
    'modal_gps_table_button': {
        'en': "Use",
        'cs': "Použi"
    },
    'modal_gps_table_message': {
        'en': "The specified location couldn't be geocoded!",
        'cs': "Zadanou polohu nebylo možné geokódovat!"
    },
    'modal_gps_table_used_value': {
        'en': "Value used for the search",
        'cs': "Hodnota použitá pro hledání"
    },
    'modal_gps_table_geocoding': {
        'en': "Geocoding the specified location...",
        'cs': "Geokódování zadané polohy..."
    },
    'modal_event_details_title': {
        'en': "Event's Details",
        'cs': "Podrobnosti akce"
    },
    'modal_event_details_value_unknown': {
        'en': "unknown",
        'cs': "neznámo"
    },
    'modal_event_details_column_gps': {
        'en': "GPS",
        'cs': "GPS"
    },
    'modal_event_details_column_organizer': {
        'en': "Organizer",
        'cs': "Organizátor"
    },
    'modal_event_details_column_types': {
        'en': "Types",
        'cs': "Typy"
    },
    'modal_event_details_column_keywords': {
        'en': "Keywords",
        'cs': "Klíčová slova"
    },
    'modal_event_details_column_source': {
        'en': "Source",
        'cs': "Zdroj"
    },
    'modal_event_details_column_fetched_at': {
        'en': "Fetched at",
        'cs': "Získáno"
    },
    'modal_calendar_sources_title': {
        'en': "Calendar Sources",
        'cs': "Zdroje kalendářů"
    },
    'modal_events_table_title': {
        'en': "Events Found",
        'cs': "Nalezené akce"
    },
    'modal_events_table_column_title': {
        'en': "Title",
        'cs': "Název"
    },
    'modal_events_table_column_start': {
        'en': "Start",
        'cs': "Začátek"
    },
    'modal_events_table_column_end': {
        'en': "End",
        'cs': "Konec"
    },
    'modal_events_table_column_actions': {
        'en': "Actions",
        'cs': "Možnosti"
    },
    'modal_events_table_online_alert': {
        'en': "You can't zoom to this event as it is being held online.",
        'cs': "Nemůžete přiblížit tuto událost, protože se koná online."
    },
    'modal_details_btn_title': {
        'en': "Show event's details.",
        'cs': "Zobrazit podrobnosti akce."
    },
    'modal_events_table_zoom_btn_title': {
        'en': "Zoom event's location on the map.",
        'cs': "Přiblížení polohy události na mapě."
    },
    'form_geocoding_heading': {
        'en': "Acquiring GPS",
        'cs': "Získání GPS"
    },
    'form_geocoding_search_label': {
        'en': "Location",
        'cs': "Poloha"
    },
    'form_geocoding_search_placeholder': {
        'en': "Search",
        'cs': "Vyhledat"
    },
    'form_filtering_content_heading': {
        'en': "Filtering by Content",
        'cs': "Filtrování podle obsahu"
    },
    'form_filtering_content_select_types': {
        'en': "Types",
        'cs': "Typy"
    },
    'form_filtering_content_select_types_header': {
        'en': "Retrieves events of at least one of the selected types.",
        'cs': "Získá akce alespoň jednoho z vybraných typů."
    },
    'form_filtering_content_select_keywords': {
        'en': "Keywords",
        'cs': "Klíčová slova"
    },
    'form_filtering_content_select_keywords_header': {
        'en': "Retrieves events containing at least one of the selected keywords.",
        'cs': "Získá akce obsahující alespoň jedno z vybraných klíčových slov."
    },
    'form_filtering_location_heading': {
        'en': "Narrowing Location",
        'cs': "Zúžení polohy"
    },
    'form_filtering_location_radio_all': {
        'en': "ALL",
        'cs': "VŠE"
    },
    'form_filtering_location_radio_online': {
        'en': "ONLINE",
        'cs': "ONLINE"
    },
    'form_filtering_location_gps': {
        'en': "GPS",
        'cs': "GPS"
    },
    'form_filtering_location_gps_title': {
        'en': "Use a decimal format of a coordinate.",
        'cs': "Použijte desítkový formát souřadnice."
    },
    'form_filtering_location_radius': {
        'en': "Radius",
        'cs': "Poloměr"
    },
    'form_filtering_datetime_heading': {
        'en': "Specifying Dates",
        'cs': "Určení dátumů"
    },
    'form_filtering_datetime_button_today': {
        'en': "Today",
        'cs': "Dnes"
    },
    'form_filtering_datetime_button_tomorrow': {
        'en': "Tomorrow",
        'cs': "Zítra"
    },
    'form_filtering_datetime_button_next_10_days': {
        'en': "Next 10 days",
        'cs': "Dalších 10 dní"
    },
    'form_filtering_datetime_checkbox_label': {
        'en': "Include",
        'cs': "Zahrň"
    },
    'form_filtering_datetime_checkbox_long_term': {
        'en': "Long-term Events (3+ weeks)",
        'cs': "Dlouhodobé akce (3+ týdnů)"
    },
    'form_filtering_datetime_checkbox_on_going': {
        'en': "Ongoing Events",
        'cs': "Probíhající akce"
    },
    'form_filtering_datetime_picker_start': {
        'en': "Start",
        'cs': "Začátek"
    },
    'form_filtering_datetime_picker_end': {
        'en': "End",
        'cs': "Konec"
    },
    'form_filtering_submit_button': {
        'en': "Search",
        'cs': "Vyhledat"
    },
    'content_search_form_bookmark': {
        'en': "Search Form",
        'cs': "Vyhledávací formulář"
    },
    'content_map_card_title': {
        'en': "Included Events",
        'cs': "Zahrnuté akce"
    },
    'content_map_show_table_btn': {
        'en': "Show Events Table",
        'cs': "Zobrazit tabulku akcí"
    },
    'crawler_counts_header': {
        'en': "Counts",
        'cs': "Počty"
    },
    'crawler_counts_all': {
        'en': "All Events",
        'cs': "Všechny akce"
    },
    'crawler_counts_future': {
        'en': "Future Events",
        'cs': "Budoucí akce"
    },
    'crawler_table_column_date': {
        'en': "Date",
        'cs': "Datum"
    },
    'crawler_table_column_calendar_url': {
        'en': "Calendar URL",
        'cs': "URL kalendáře"
    },
    'crawler_table_per_day_title': {
        'en': "Events per Day",
        'cs': "Akce za den"
    },
    'crawler_table_per_day_timespan': {
        'en': "last 2 weeks",
        'cs': "poslední 2 týdny"
    },
    'crawler_table_per_day_column_count': {
        'en': "Count",
        'cs': "Počet"
    },
    'crawler_table_per_week_title': {
        'en': "Events per Week",
        'cs': "Akce za týden"
    },
    'crawler_table_per_week_timespan': {
        'en': "last year",
        'cs': "poslední rok"
    },
    'crawler_table_events_title': {
        'en': "Events",
        'cs': "Akce"
    },
    'crawler_table_per_calendar_title': {
        'en': "per Calendar",
        'cs': "na kalendář"
    },
    'crawler_table_per_parser_title': {
        'en': "per Parser",
        'cs': "na analyzátor"
    },
    'crawler_failures_header': {
        'en': "Failures",
        'cs': "Selhání"
    },
    'crawler_table_failing_calendars_title': {
        'en': "Failing Calendars",
        'cs': "Selhávající kalendáře"
    },
    'crawler_table_failing_calendars_details': {
        'en': "Download of these calendars is failing for at least last 3 days consecutively.",
        'cs': "Stahování těchto kalendářů selhalo nejméně po dobu posledních 3 dnů po sobě."
    },
    'crawler_table_empty_calendars_title': {
        'en': "Empty Calendars",
        'cs': "Prázdné kalendáře"
    },
    'crawler_table_empty_calendars_details': {
        'en': "No events were acquired from these calendars for at least last 2 weeks consecutively.",
        'cs': "Z těchto kalendářů nebyly získány žádné události nejméně za poslední 2 týdny po sobě."
    },
    'crawler_table_empty_calendars_checkbox_label': {
        'en': "Hide",
        'cs': "Skrýt"
    },
    'crawler_table_empty_calendars_checkbox_vismo': {
        'en': "Vismo calendars",
        'cs': "Vismo kalendáře"
    },
    'crawler_table_empty_calendars_checkbox_vismo_title': {
        'en': "Hides calendars using 'vismo' parser.",
        'cs': "Skryje kalendáře analyzátora „vismo“."
    },
    'crawler_table_empty_calendars_checkbox_always': {
        'en': "Always empty calendars",
        'cs': "Vždy prázdné kalendáře"
    },
    'crawler_table_empty_calendars_checkbox_always_title': {
        'en': "Hides calendars that have produced no events so far.",
        'cs': "Skryje kalendáře, které dosud nepřinesly žádné události."
    },
    'crawler_table_failure_rate_title': {
        'en': "Calendars with Failed Events",
        'cs': "Kalendáře s neúspěšnými akcemi"
    },
    'crawler_table_failure_rate_percentage': {
        'en': "more than 10%",
        'cs': "více než 10%"
    },
    'crawler_table_failure_rate_details': {
        'en': "A substantial part of the events from these calendars fails.",
        'cs': "Podstatná část akcí z těchto kalendářů selhává."
    },
    'crawler_table_failure_rate_column_rate': {
        'en': "Failure Rate",
        'cs': "Míra selhání"
    },
    'crawler_table_failed_events_title': {
        'en': "Failed Events",
        'cs': "Neúspěšné akce"
    },
    'crawler_table_failed_events_timespan': {
        'en': "last week",
        'cs': "poslední týden"
    },
    'crawler_table_failed_events_details': {
        'en': "Events that couldn't be parsed and a cause of such a failure.",
        'cs': "Události, které nešlo zanalyzovat, a příčina takového selhání."
    },
    'crawler_table_failed_event_codes_explanation_title': {
        'en': "What does Cause of Failure code stands for?",
        'cs': "Co znamená kód příčiny selhání?"
    },
    'crawler_table_failed_event_event_html_not_downloaded': {
        'en': "failed to download event's HTML content",
        'cs': "nepodařilo se stáhnout HTML obsah akce"
    },
    'crawler_table_failed_event_event_html_not_downloaded_probably': {
        'en': "probably faulty event's URL",
        'cs': "pravděpodobně chybná URL adresa akce"
    },
    'crawler_table_failed_event_event_data_not_parsed': {
        'en': "failed to parse data from event's HTML",
        'cs': "nepodařilo se zanalyzovat data z HTML akce"
    },
    'crawler_table_failed_event_event_data_not_parsed_probably': {
        'en': "probably missing title or date",
        'cs': "pravděpodobně chybí název nebo datum"
    },
    'crawler_table_failed_event_event_datetime_not_processed': {
        'en': "failed to process event's date",
        'cs': "nepodařilo se zpracovat datum akce"
    },
    'crawler_table_failed_event_event_datetime_not_processed_probably': {
        'en': "probably doesn't match format for its parser",
        'cs': "pravděpodobně neodpovídá formátu z jeho analyzátoru"
    },
    'crawler_table_failed_event_event_gps_not_acquired': {
        'en': "failed to acquire event's GPS",
        'cs': "nepodařilo se získat GPS akce"
    },
    'crawler_table_failed_event_event_gps_not_acquired_probably': {
        'en': "probably missing or ambiguous location",
        'cs': "pravděpodobně chybějící nebo nejednoznačná poloha"
    },
    'crawler_table_failed_events_event_url': {
        'en': "Event URL",
        'cs': "URL akce"
    },
    'crawler_table_failed_events_failure_cause': {
        'en': "Cause of Failure",
        'cs': "Příčina selhání"
    }
};

function getLocalizedString(key) {
    const currentLang = getCurrentLang();
    return localizationStrings[key][currentLang];
}

function replaceLocalizationStrings(lang) {
    document.title = localizationStrings['website_title'][lang];
    const re = new RegExp(Object.keys(localizationStrings).map(x => `%%${x}%%`).join("|"), "gi");
    document.body.innerHTML = document.body.innerHTML.replace(re, function (matched) {
        return localizationStrings[matched.slice(2, -2)][lang];
    });
}

function getCurrentLang() {
    let params = new URLSearchParams(window.location.search);
    if (params.get('lang') === 'cs') {
        return 'cs';
    } else if (params.get('lang') === 'en') {
        return 'en';
    } else {
        return 'en';
    }
}

function handleLocalizationChange(lang) {
    const currentLang = getCurrentLang();
    if (lang !== currentLang) {
        const queryParams = new URLSearchParams(window.location.search);
        queryParams.set("lang", lang);
        window.location.search = queryParams.toString();

        replaceLocalizationStrings(lang);
        document.querySelectorAll(`.navbar-lang`).forEach(function (node) {
            node.style.color = "#ffffff80";
        });
        document.getElementById(`lang-${lang}`).style.color = "#ffffff";
    }
}

function handleFirstLocalization() {
    let currentLang = getCurrentLang();

    replaceLocalizationStrings(currentLang);
    document.querySelectorAll(`.navbar-lang`).forEach(function (node) {
        node.style.color = "#ffffff80";
    });
    document.getElementById(`lang-${currentLang}`).style.color = "#ffffff";
}